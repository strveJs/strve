/*!
 * Strve.js v6.6.0
 * (c) 2021-2024 maomincoding
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Strve={})}(this,(function(t){"use strict";const e=(t,n,o,i)=>{let s;n[0]=0;for(let r=1;r<n.length;r++){const l=n[r++],c=n[r]?(n[0]|=l?1:2,o[n[r++]]):n[++r];3===l?i[0]=c:4===l?i[1]=Object.assign(i[1]||{},c):5===l?(i[1]=i[1]||{})[n[++r]]=c:6===l?i[1][n[++r]]+=c+"":l?(s=t.apply(c,e(t,c,o,["",null])),i.push(s),c[0]?n[0]|=2:(n[r-2]=0,n[r]=s)):i.push(c)}return i},n=new Map,o=function(t){let o=n.get(this);return o||(o=new Map,n.set(this,o)),o=e(this,o.get(t)||(o.set(t,o=function(t){let e,n,o=1,i="",s="",r=[0];const l=t=>{1===o&&(t||(i=i.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?r.push(0,t,i):3===o&&(t||i)?(r.push(3,t,i),o=2):2===o&&"..."===i&&t?r.push(4,t,0):2===o&&i&&!t?r.push(5,0,!0,i):o>=5&&((i||!t&&5===o)&&(r.push(o,0,i,n),o=6),t&&(r.push(o,t,0,n),o=6)),i=""};for(let c=0;c<t.length;c++){c&&(1===o&&l(),l(c));for(let a=0;a<t[c].length;a++)e=t[c][a],1===o?"<"===e?(l(),r=[r],o=3):i+=e:4===o?"--"===i&&">"===e?(o=1,i=""):i=e+i[0]:s?e===s?s="":i+=e:'"'===e||"'"===e?s=e:">"===e?(l(),o=1):o&&("="===e?(o=5,n=i,i=""):"/"===e&&(o<5||">"===t[c][a+1])?(l(),3===o&&(r=r[0]),o=r,(r=r[0]).push(2,0,o),o=0):" "===e||"\t"===e||"\n"===e||"\r"===e?(l(),o=2):i+=e),3===o&&"!--"===i&&(o=4,r=r[0])}return l(),r}(t)),o),arguments,[]),o.length>1?o:o[0]}.bind((function(t,e,n){let o=null,i=null,s=null;for(i in e)"key"===i&&(o=e[i]);return arguments.length>2&&(s=arguments.length>3?Array.prototype.slice.call(arguments,2):n),{tag:t,props:e,children:s,key:o,el:null}}));function i(t){const e=Object.create(null),n=t.split(",");for(let t=0;t<n.length;t++)e[n[t]]=!0;return function(t){return e[t]}}const s=i("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot"),r=i("svg,animate,circle,clippath,cursor,image,defs,desc,ellipse,filter,font-faceforeignobject,g,glyph,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feFlood,feGaussianBlur,feImage,feMerge,feMorphology,feOffset,feSpecularLighting,feTile,feTurbulence,feDistantLight,fePointLight,feSpotLight,linearGradient,stop,radialGradient,animateTransform,animateMotion");function l(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)}const c={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},a="http://www.w3.org/1999/xlink";function u(t){return Object.prototype.toString.call(t).match(/\[object (.+?)\]/)[1].toLowerCase()}const f=["object","array","function","regexp","date","math"];function h(t){return f.includes(u(t))}function p(t){return null==t}function d(t,e){return t.tag===e.tag&&t.key===e.key}function m(t,e){return t.hasOwnProperty(e)}function g(t){if(t)return m(t,"tag")&&m(t,"props")&&m(t,"children")&&m(t,"key")&&m(t,"el")}function y(t){return Array.isArray(t)?function(t){return t.every(g)}(t):g(t)}function b(t){console.warn(`[Strve warn]: ${t}`)}function w(t,e){Object.assign(t.style,e)}function v(t,e){for(const[n,o]of Object.entries(e))if(n.startsWith("on")){const e=n.slice(2).toLowerCase();t.addEventListener(e,o)}}function k(t,e,n){if(e.startsWith("on")){const o=e.slice(2,3).toLowerCase()+e.slice(3);"function"==typeof n[e]&&t.removeEventListener(o,n[e])}}function j(t,e,n){if(l(e)){const o="http://www.w3.org/1999/xlink";t.setAttributeNS(o,e,n.toString())}else t.setAttribute(e,n.toString())}function S(t,e){var n;l(e)?t.removeAttributeNS(a,l(n=e)?n.slice(6,n.length):""):t.removeAttribute(e)}function M(t){switch(!0){case s(t):return document.createElement(t);case r(t):return e=function(t){return r(t)?"svg":"math"===t?"math":void 0}(t),n=t,document.createElementNS(c[e],n);case"fragment"===t||"component"===t:return document.createDocumentFragment();case"comment"===t||"null"===t:return document.createComment(t);default:return document.createElement(t)}var e,n}const O=["$ref","$is"],_=new WeakMap,x=new WeakMap;function C(t,e){let n="";if(Array.isArray(t))if(t.length>1){let e=[];for(let n=0;n<t.length;n++){const o=t[n];e.push(h(o)?JSON.stringify(o):o)}n=e.join("")}else n=0===t.length?"":JSON.stringify(t).replace(/,/g,"");else n=h(t)?JSON.stringify(t):t;e.textContent=n}function A(t,e,n){const{tag:o,props:i,children:s}=t;if(!p(o)){const r=M(o);if(t.el=r,!p(i)){v(r,i);const t=Object.keys(i);for(let e=0;e<t.length;e++){const n=t[e],o=i[n],s=u(o);if("function"===s||"key"===n||O.includes(n)||j(r,n,o),"style"===n&&"object"===s&&w(r,o),n===O[0]&&"object"===s&&x.set(o,r),n===O[1]&&"object"===s){const t=o.template();A(t,r),_.set(o,t)}}}if("component"!==o&&!p(s))if(y(s)){const t=u(s);if("array"===t)for(let t=0;t<s.length;t++){const e=s[t];g(e)&&A(e,r)}else"object"===t&&A(s,r)}else r&&C(s,r);if(n)e.insertBefore(r,n);else{if(!e)return r;e.appendChild(r)}}}function L(t,e){if(function(t,e){return"component"!==e.tag&&"component"!==t.tag}(t,e))if(d(t,e)){const n=e.el=t.el,o=t.props||{},i=e.props||{},s=Object.keys(i),r=Object.keys(o);for(let t=0;t<s.length;t++){const e=s[t],r=i[e],l=o[e],c=u(r);r!==l&&(p(r)?S(n,e):("function"===c||"key"===e||O.includes(e)||j(n,e,r),"style"===e&&"object"===c&&w(n,r),"function"===c&&r.toString()!==l.toString()&&(k(n,e,o),v(n,i))))}for(let t=0;t<r.length;t++){const e=r[t];s.includes(e)||S(n,e)}const l=t.children,c=e.children;"array"===u(l)&&"array"===u(c)?function(t,e,n){const o=e.length;let i=0,s=t.length-1,r=o-1;for(;i<=s&&i<=r&&d(t[i],e[i]);)L(t[i],e[i]),i++;for(;i<=s&&i<=r&&d(t[s],e[r]);)L(t[s],e[r]),s--,r--;if(i>s){if(i<=r){const t=r+1,s=t<o?e[t].el:null;for(;i<=r;)n.insertBefore(A(e[i]),s),i++}}else if(i>r)for(;i<=s;)n.removeChild(t[i].el),i++;else{const l=i,c=i,a=new Map;for(i=c;i<=r;i++){const t=e[i];null!=t.key&&a.set(t.key,i)}let u,f=0;const h=r-c+1;let p=!1,m=0;const g=new Array(h);for(i=0;i<h;i++)g[i]=0;for(let o=l;o<=s;o++){if(f>=h){n.removeChild(t[o].el);continue}let i;if(null!==t[o].key)i=a.get(t[o].key);else for(u=c;u<=r;u++)if(0===g[u-c]&&d(t[o],e[u])){i=u;break}void 0===i?n.removeChild(t[o].el):(g[i-c]=o+1,i>m?m=i:p=!0,L(t[o],e[i]),f++)}const y=p?function(t){const e=t.slice(),n=[0];let o,i,s,r,l;const c=t.length;for(o=0;o<c;o++){const c=t[o];if(0!==c){if(i=n[n.length-1],t[i]<c){e[o]=i,n.push(o);continue}for(s=0,r=n.length-1;s<r;)l=(s+r)/2|0,t[n[l]]<c?s=l+1:r=l;c<t[n[s]]&&(s>0&&(e[o]=n[s-1]),n[s]=o)}}for(s=n.length,r=n[s-1];s-- >0;)n[s]=r,r=e[r];return n}(g):[];u=y.length-1;for(let t=h-1;t>=0;t--){const i=t+c,s=i+1<o?e[i+1].el:null;0===g[t]?n.insertBefore(A(e[i]),s):p&&(u<0||t!==y[u]?n.insertBefore(e[i].el,s):u--)}}}(l,c,n):g(l)&&g(c)?L(l,c):y(l)||y(c)||l===c||C(c,n)}else{const n=t.el.parentNode,o=t.el.nextSibling;n.removeChild(t.el),A(e,n,o)}}async function E(t,e){if("function"==typeof t&&"undefined"!=typeof Promise)try{await Promise.resolve(t());const n=e||this,o=n.template();L(_.get(n),o),_.set(n,o)}catch(t){b(t)}}let T=Object.create(null);t.createStateFlow=class{_mutations;_actions;_state;constructor(t){this._mutations=t.mutations,this._actions=t.actions,this._state=new Proxy(t.state,{set:(t,e,n)=>(this._mutations[e]&&this._mutations[e](t,n),t[e]=n,!0)})}commit(t,e){this._mutations[t]&&this._mutations[t](this._state,e)}async dispatch(t,e){this._actions[t]&&await this._actions[t](this,e)}get state(){return this._state}},t.defineComponent=function(t,e){"function"==typeof t&&(e=t,t=Object.create(null));class n{template;static instance;constructor(){const n={content:this,setData:E.bind(this)},o=e.call(this,n);this.template=o;const i=o();if(t.mount){const e=function(t){if("string"==typeof t){const e=document.querySelector(t);if(!e){let e=null;return t.startsWith("#")?(e=document.createElement("div"),e.setAttribute("id",t.substring(1,t.length))):t.startsWith(".")?(e=document.createElement("div"),e.setAttribute("class",t.substring(1,t.length))):b(`Failed to mount app: mount target selector "${t}" returned null.`),document.body.insertAdjacentElement("afterbegin",e),e}return e}return t instanceof HTMLElement?t:window.ShadowRoot&&t instanceof window.ShadowRoot&&"closed"===t.mode?(b('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs.'),null):null}(t.mount);A(i,e),_.set(this,i),T=e}}static getInstance(){return this.instance||(this.instance=new n),this.instance}}return n.getInstance()},t.domInfo=x,t.html=o,t.resetView=function(t){T.innerHTML="";const e=t.template();A(e,T),_.set(t,e)},t.setData=E,t.version="6.6.0",Object.defineProperty(t,"__esModule",{value:!0})}));
