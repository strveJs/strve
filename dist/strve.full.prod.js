/*!
 * Strve.js v6.1.0
 * (c) 2021-2023 maomincoding
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Strve={})}(this,(function(e){"use strict";const t=(e,n,o,s)=>{let i;n[0]=0;for(let r=1;r<n.length;r++){const l=n[r++],a=n[r]?(n[0]|=l?1:2,o[n[r++]]):n[++r];3===l?s[0]=a:4===l?s[1]=Object.assign(s[1]||{},a):5===l?(s[1]=s[1]||{})[n[++r]]=a:6===l?s[1][n[++r]]+=a+"":l?(i=e.apply(a,t(e,a,o,["",null])),s.push(i),a[0]?n[0]|=2:(n[r-2]=0,n[r]=i)):s.push(a)}return s},n=new Map,o=function(e){let o=n.get(this);return o||(o=new Map,n.set(this,o)),o=t(this,o.get(e)||(o.set(e,o=function(e){let t,n,o=1,s="",i="",r=[0];const l=e=>{1===o&&(e||(s=s.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?r.push(0,e,s):3===o&&(e||s)?(r.push(3,e,s),o=2):2===o&&"..."===s&&e?r.push(4,e,0):2===o&&s&&!e?r.push(5,0,!0,s):o>=5&&((s||!e&&5===o)&&(r.push(o,0,s,n),o=6),e&&(r.push(o,e,0,n),o=6)),s=""};for(let a=0;a<e.length;a++){a&&(1===o&&l(),l(a));for(let c=0;c<e[a].length;c++)t=e[a][c],1===o?"<"===t?(l(),r=[r],o=3):s+=t:4===o?"--"===s&&">"===t?(o=1,s=""):s=t+s[0]:i?t===i?i="":s+=t:'"'===t||"'"===t?i=t:">"===t?(l(),o=1):o&&("="===t?(o=5,n=s,s=""):"/"===t&&(o<5||">"===e[a][c+1])?(l(),3===o&&(r=r[0]),o=r,(r=r[0]).push(2,0,o),o=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(l(),o=2):s+=t),3===o&&"!--"===s&&(o=4,r=r[0])}return l(),r}(e)),o),arguments,[]),o.length>1?o:o[0]}.bind((function(e,t,n){let o=null,s=null,i=null;for(s in t)"key"===s&&(o=t[s]);return arguments.length>2&&(i=arguments.length>3?Array.prototype.slice.call(arguments,2):n),{tag:e,props:t,children:i,key:o,el:null}}));function s(e){const t=Object.create(null),n=e.split(",");for(let e=0;e<n.length;e++)t[n[e]]=!0;return function(e){return t[e]}}const i=s("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot"),r=s("svg,animate,circle,clippath,cursor,image,defs,desc,ellipse,filter,font-faceforeignobject,g,glyph,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feFlood,feGaussianBlur,feImage,feMerge,feMorphology,feOffset,feSpecularLighting,feTile,feTurbulence,feDistantLight,fePointLight,feSpotLight,linearGradient,stop,radialGradient,animateTransform,animateMotion");function l(e){return":"===e.charAt(5)&&"xlink"===e.slice(0,5)}const a={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},c="http://www.w3.org/1999/xlink";function u(e){return Object.prototype.toString.call(e).match(/\[object (.+?)\]/)[1].toLowerCase()}const f=["object","array","function","regexp","date","math"];function d(e){return f.includes(u(e))}function h(e){return null==e}function p(e,t){return e.tag===t.tag&&e.key===t.key}function m(e,t){return e.hasOwnProperty(t)}function g(e){if(e)return m(e,"tag")&&m(e,"props")&&m(e,"children")&&m(e,"key")&&m(e,"el")}function b(e){return Array.isArray(e)?function(e){return e.every(g)}(e):g(e)}function y(e){console.warn(`[Strve warn]: ${e}`)}function w(e,t){Object.assign(e.style,t)}function C(e,t){for(const[n,o]of Object.entries(t))if(n.startsWith("on")){const t=n.slice(2).toLowerCase();e.addEventListener(t,o)}}function k(e,t,n){if(t.startsWith("on")){const o=t.slice(2,3).toLowerCase()+t.slice(3);"function"==typeof n[t]&&e.removeEventListener(o,n[t])}}function v(e,t,n){if(l(t)){const o="http://www.w3.org/1999/xlink";e.setAttributeNS(o,t,n.toString())}else e.setAttribute(t,n.toString())}function j(e,t){var n;l(t)?e.removeAttributeNS(c,l(n=t)?n.slice(6,n.length):""):e.removeAttribute(t)}function O(e){switch(!0){case i(e):return document.createElement(e);case r(e):return t=function(e){return r(e)?"svg":"math"===e?"math":void 0}(e),n=e,document.createElementNS(a[t],n);case"fragment"===e||"component"===e:return document.createDocumentFragment();case"comment"===e||"null"===e:return document.createComment(e);default:return document.createElement(e)}var t,n}let M=Object.create(null),S=Object.create(null),x=Object.create(null);const A=["$ref","$name","$define"],T=new WeakMap,_=new WeakMap;function E(e,t){let n="";if(Array.isArray(e))if(e.length>1){let t=[];for(let n=0;n<e.length;n++){const o=e[n];t.push(d(o)?JSON.stringify(o):o)}n=t.join("")}else n=0===e.length?"":JSON.stringify(e).replace(/,/g,"");else n=d(e)?JSON.stringify(e):e;t.textContent=n}function L(e,t,n){const{tag:o,props:s,children:i}=e;if(!h(o)){const r=O(o);if(e.el=r,!h(s)){C(r,s);const e=Object.keys(s);for(let t=0;t<e.length;t++){const n=e[t],o=s[n],l=u(o);if("function"===l||"key"===n||A.includes(n)||v(r,n,o),"style"===n&&"object"===l&&w(r,o),n===A[0]&&"object"===l&&_.set(o,r),n===A[1]&&"object"===l&&T.set(o,i),n===A[2]&&"array"===l){const[e,t]=o;if(customElements.get(e.name)){const n=t.template();T.set(e,{template:n,props:null})}else N(o)}}}if(!h(i))if(b(i)){const e=u(i);if("array"===e)for(let e=0;e<i.length;e++){const t=i[e];g(t)&&L(t,r)}else"object"===e&&L(i,r)}else r&&E(i,r);if(n)t.insertBefore(r,n);else{if(!t)return r;t.appendChild(r)}}}function P(e,t){if(p(e,t)){const n=t.el=e.el,o=e.props||{},s=t.props||{},i=Object.keys(s),r=Object.keys(o);for(let e=0;e<i.length;e++){const t=i[e],r=s[t],l=o[t],a=u(r);r!==l&&(h(r)?j(n,t):("function"===a||"key"===t||A.includes(t)||v(n,t,r),"style"===t&&"object"===a&&w(n,r),"function"===a&&r.toString()!==l.toString()&&(k(n,t,o),C(n,s))))}for(let e=0;e<r.length;e++){const t=r[e];i.includes(t)||j(n,t)}const l=e.children,a=t.children;"array"===u(l)&&"array"===u(a)?function(e,t,n){const o=t.length;let s=0,i=e.length-1,r=o-1;for(;s<=i&&s<=r&&p(e[s],t[s]);)P(e[s],t[s]),s++;for(;s<=i&&s<=r&&p(e[i],t[r]);)P(e[i],t[r]),i--,r--;if(s>i){if(s<=r){const e=r+1,i=e<o?t[e].el:null;for(;s<=r;)n.insertBefore(L(t[s]),i),s++}}else if(s>r)for(;s<=i;)n.removeChild(e[s].el),s++;else{const l=s,a=s,c=new Map;for(s=a;s<=r;s++){const e=t[s];null!=e.key&&c.set(e.key,s)}let u,f=0;const d=r-a+1;let h=!1,m=0;const g=new Array(d);for(s=0;s<d;s++)g[s]=0;for(let o=l;o<=i;o++){if(f>=d){n.removeChild(e[o].el);continue}let s;if(null!==e[o].key)s=c.get(e[o].key);else for(u=a;u<=r;u++)if(0===g[u-a]&&p(e[o],t[u])){s=u;break}void 0===s?n.removeChild(e[o].el):(g[s-a]=o+1,s>m?m=s:h=!0,P(e[o],t[s]),f++)}const b=h?function(e){const t=e.slice(),n=[0];let o,s,i,r,l;const a=e.length;for(o=0;o<a;o++){const a=e[o];if(0!==a){if(s=n[n.length-1],e[s]<a){t[o]=s,n.push(o);continue}for(i=0,r=n.length-1;i<r;)l=(i+r)/2|0,e[n[l]]<a?i=l+1:r=l;a<e[n[i]]&&(i>0&&(t[o]=n[i-1]),n[i]=o)}}for(i=n.length,r=n[i-1];i-- >0;)n[i]=r,r=t[r];return n}(g):[];u=b.length-1;for(let e=d-1;e>=0;e--){const s=e+a,i=s+1<o?t[s+1].el:null;0===g[e]?n.insertBefore(L(t[s]),i):h&&(u<0||e!==b[u]?n.insertBefore(t[s].el,i):u--)}}}(l,a,n):g(l)&&g(a)?P(l,a):b(l)||b(a)||l===a||E(a,n)}else{const n=e.el.parentNode,o=e.el.nextSibling;n.removeChild(e.el),L(t,n,o)}}function N(e){const[t,n]=e;class o extends HTMLElement{shadow;props;isComMounted;comOldTree;static get observedAttributes(){if(n.attributeChanged&&n.attributeChanged.length>0)return n.attributeChanged}constructor(){if(super(),this.shadow=null,this.props=Object.create(null),this.isComMounted=!1,this.comOldTree=Object.create(null),n.template&&t.name){const e=document.createElement("template");e.setAttribute("id",t.name);const o=e.content.cloneNode(!0);if(n.styles&&Array.isArray(n.styles)){const e=document.createElement("style");e.textContent=n.styles.join(""),o.appendChild(e)}if(this.shadow=this.attachShadow({mode:"open"}),this.shadow.appendChild(o),!n.attributeChanged){const e=n.template();L(e,this.shadow),T.set(t,{template:e,props:null})}}}connectedCallback(){const e=arguments;n.lifetimes&&"function"==typeof n.lifetimes.connectedCallback&&n.lifetimes.connectedCallback(e)}disconnectedCallback(){const e=arguments;n.lifetimes&&"function"==typeof n.lifetimes.disconnectedCallback&&n.lifetimes.disconnectedCallback(e)}adoptedCallback(){const e=arguments;n.lifetimes&&"function"==typeof n.lifetimes.adoptedCallback&&n.lifetimes.adoptedCallback(e)}attributeChangedCallback(){const e=arguments;if(n.attributeChanged&&n.attributeChanged.length>0){this.props[e[0]]=e[2];const o=n.template(this.props);this.isComMounted?(P(this.comOldTree,o),T.set(t,{template:o,props:this.props}),this.comOldTree=o):(L(o,this.shadow),T.set(t,{template:o,props:this.props}),this.comOldTree=o,this.isComMounted=!0)}n.immediateProps&&n.lifetimes&&"function"==typeof n.lifetimes.attributeChangedCallback&&n.lifetimes.attributeChangedCallback(e)}}-1!==t.name.indexOf("-")?customElements.define(t.name,o):y(`[${t.name}]>> please name the string with "-" as a custom element.`)}let $=[];let B=[];const W="undefined"!==u(Promise)&&Promise.resolve();let D=!1;function F(e,t){if(D){const t=e;P(x,t),x=t}else{if(L(e,t),x=e,D=!0,$.length>0)for(let e=0,t=$.length;e<t;e++)$[e]&&$[e]();$=[]}}e.createApp=function(e){return{mount(t){const n=function(e){if("string"==typeof e){const t=document.querySelector(e);if(!t){let t=null;return e.startsWith("#")?(t=document.createElement("div"),t.setAttribute("id",e.substring(1,e.length))):e.startsWith(".")?(t=document.createElement("div"),t.setAttribute("class",e.substring(1,e.length))):y(`Failed to mount app: mount target selector "${e}" returned null.`),document.body.insertAdjacentElement("afterbegin",t),t}return t}return e instanceof HTMLElement?e:window.ShadowRoot&&e instanceof window.ShadowRoot&&"closed"===e.mode?(y('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs.'),null):null}(t);if(n){const t=e();"array"===u(t)?y("Please provide a root node."):(S=e,M=n,F(t,M))}else y("There must be a mount element node.")}}},e.createStateFlow=class{_mutations;_actions;_state;constructor(e){this._mutations=e.mutations,this._actions=e.actions,this._state=new Proxy(e.state,{set:(e,t,n)=>(this._mutations[t]&&this._mutations[t](e,n),e[t]=n,!0)})}commit(e,t){this._mutations[e]&&this._mutations[e](this._state,t)}async dispatch(e,t){this._actions[e]&&await this._actions[e](this,t)}get state(){return this._state}},e.domInfo=_,e.html=o,e.nextTick=e=>W.then(e),e.onMounted=function(e=null){null!==e&&("function"==typeof e?$.push(e):console.warn("The parameter of onMounted is not a function!"))},e.onUnmounted=function(e=null){null!==e&&("function"==typeof e?B.push(e):console.warn("The parameter of onUnmounted is not a function!"))},e.registerComponent=function(e){const t=Object.create(null);return e?(t.name=e,t):t},e.setData=function(e,t){if("function"==typeof e&&"undefined"!=typeof Promise)return Promise.resolve().then((()=>{e()})).then((()=>{if(t){const e=u(t);if("array"===e&&"function"==typeof t[1]){const[e,n]=t,o=n();P(T.get(e),o),T.set(e,o)}else if("array"===e&&"object"==typeof t[1]){const[e,n]=t,{template:o,props:s}=T.get(e),i=n.template(s);P(o,i),T.set(e,i)}else if("string"===e&&"useRouter"===t){if(B.length>0)for(let e=0,t=B.length;e<t;e++)B[e]&&B[e]();B=[],D=!1,M.innerHTML="";F(S(),M)}}else{F(S(),null)}})).catch((e=>y(e)))},e.version="6.1.0",Object.defineProperty(e,"__esModule",{value:!0})}));
