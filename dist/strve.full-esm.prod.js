/*!
 * Strve.js v6.1.0
 * (c) 2021-2023 maomincoding
 * Released under the MIT License.
 */
const t=(e,n,o,s)=>{let i;n[0]=0;for(let r=1;r<n.length;r++){const l=n[r++],a=n[r]?(n[0]|=l?1:2,o[n[r++]]):n[++r];3===l?s[0]=a:4===l?s[1]=Object.assign(s[1]||{},a):5===l?(s[1]=s[1]||{})[n[++r]]=a:6===l?s[1][n[++r]]+=a+"":l?(i=e.apply(a,t(e,a,o,["",null])),s.push(i),a[0]?n[0]|=2:(n[r-2]=0,n[r]=i)):s.push(a)}return s},e=new Map,n=function(n){let o=e.get(this);return o||(o=new Map,e.set(this,o)),o=t(this,o.get(n)||(o.set(n,o=function(t){let e,n,o=1,s="",i="",r=[0];const l=t=>{1===o&&(t||(s=s.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?r.push(0,t,s):3===o&&(t||s)?(r.push(3,t,s),o=2):2===o&&"..."===s&&t?r.push(4,t,0):2===o&&s&&!t?r.push(5,0,!0,s):o>=5&&((s||!t&&5===o)&&(r.push(o,0,s,n),o=6),t&&(r.push(o,t,0,n),o=6)),s=""};for(let a=0;a<t.length;a++){a&&(1===o&&l(),l(a));for(let c=0;c<t[a].length;c++)e=t[a][c],1===o?"<"===e?(l(),r=[r],o=3):s+=e:4===o?"--"===s&&">"===e?(o=1,s=""):s=e+s[0]:i?e===i?i="":s+=e:'"'===e||"'"===e?i=e:">"===e?(l(),o=1):o&&("="===e?(o=5,n=s,s=""):"/"===e&&(o<5||">"===t[a][c+1])?(l(),3===o&&(r=r[0]),o=r,(r=r[0]).push(2,0,o),o=0):" "===e||"\t"===e||"\n"===e||"\r"===e?(l(),o=2):s+=e),3===o&&"!--"===s&&(o=4,r=r[0])}return l(),r}(n)),o),arguments,[]),o.length>1?o:o[0]}.bind((function(t,e,n){let o=null,s=null,i=null;for(s in e)"key"===s&&(o=e[s]);return arguments.length>2&&(i=arguments.length>3?Array.prototype.slice.call(arguments,2):n),{tag:t,props:e,children:i,key:o,el:null}}));function o(t){const e=Object.create(null),n=t.split(",");for(let t=0;t<n.length;t++)e[n[t]]=!0;return function(t){return e[t]}}const s=o("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot"),i=o("svg,animate,circle,clippath,cursor,image,defs,desc,ellipse,filter,font-faceforeignobject,g,glyph,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feFlood,feGaussianBlur,feImage,feMerge,feMorphology,feOffset,feSpecularLighting,feTile,feTurbulence,feDistantLight,fePointLight,feSpotLight,linearGradient,stop,radialGradient,animateTransform,animateMotion");function r(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)}const l={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},a="http://www.w3.org/1999/xlink";function c(t){return Object.prototype.toString.call(t).match(/\[object (.+?)\]/)[1].toLowerCase()}const u=["object","array","function","regexp","date","math"];function f(t){return u.includes(c(t))}function h(t){return null==t}function d(t,e){return t.tag===e.tag&&t.key===e.key}function p(t,e){return t.hasOwnProperty(e)}function m(t){if(t)return p(t,"tag")&&p(t,"props")&&p(t,"children")&&p(t,"key")&&p(t,"el")}function g(t){return Array.isArray(t)?function(t){return t.every(m)}(t):m(t)}function b(t){console.warn(`[Strve warn]: ${t}`)}function y(t,e){Object.assign(t.style,e)}function w(t,e){for(const[n,o]of Object.entries(e))if(n.startsWith("on")){const e=n.slice(2).toLowerCase();t.addEventListener(e,o)}}function C(t,e,n){if(e.startsWith("on")){const o=e.slice(2,3).toLowerCase()+e.slice(3);"function"==typeof n[e]&&t.removeEventListener(o,n[e])}}function k(t,e,n){if(r(e)){const o="http://www.w3.org/1999/xlink";t.setAttributeNS(o,e,n.toString())}else t.setAttribute(e,n.toString())}function v(t,e){var n;r(e)?t.removeAttributeNS(a,r(n=e)?n.slice(6,n.length):""):t.removeAttribute(e)}function j(t){switch(!0){case s(t):return document.createElement(t);case i(t):return e=function(t){return i(t)?"svg":"math"===t?"math":void 0}(t),n=t,document.createElementNS(l[e],n);case"fragment"===t||"component"===t:return document.createDocumentFragment();case"comment"===t||"null"===t:return document.createComment(t);default:return document.createElement(t)}var e,n}const O="6.1.0";let M=Object.create(null),S=Object.create(null),A=Object.create(null);const x=["$ref","$name","$define"],T=new WeakMap,E=new WeakMap;function L(t){const e=Object.create(null);return t?(e.name=t,e):e}function _(t,e){let n="";if(Array.isArray(t))if(t.length>1){let e=[];for(let n=0;n<t.length;n++){const o=t[n];e.push(f(o)?JSON.stringify(o):o)}n=e.join("")}else n=0===t.length?"":JSON.stringify(t).replace(/,/g,"");else n=f(t)?JSON.stringify(t):t;e.textContent=n}function P(t,e,n){const{tag:o,props:s,children:i}=t;if(!h(o)){const r=j(o);if(t.el=r,!h(s)){w(r,s);const t=Object.keys(s);for(let e=0;e<t.length;e++){const n=t[e],o=s[n],l=c(o);if("function"===l||"key"===n||x.includes(n)||k(r,n,o),"style"===n&&"object"===l&&y(r,o),n===x[0]&&"object"===l&&E.set(o,r),n===x[1]&&"object"===l&&T.set(o,i),n===x[2]&&"array"===l){const[t,e]=o;if(customElements.get(t.name)){const n=e.template();T.set(t,{template:n,props:null})}else $(o)}}}if(!h(i))if(g(i)){const t=c(i);if("array"===t)for(let t=0;t<i.length;t++){const e=i[t];m(e)&&P(e,r)}else"object"===t&&P(i,r)}else r&&_(i,r);if(n)e.insertBefore(r,n);else{if(!e)return r;e.appendChild(r)}}}function N(t,e){if(d(t,e)){const n=e.el=t.el,o=t.props||{},s=e.props||{},i=Object.keys(s),r=Object.keys(o);for(let t=0;t<i.length;t++){const e=i[t],r=s[e],l=o[e],a=c(r);r!==l&&(h(r)?v(n,e):("function"===a||"key"===e||x.includes(e)||k(n,e,r),"style"===e&&"object"===a&&y(n,r),"function"===a&&r.toString()!==l.toString()&&(C(n,e,o),w(n,s))))}for(let t=0;t<r.length;t++){const e=r[t];i.includes(e)||v(n,e)}const l=t.children,a=e.children;"array"===c(l)&&"array"===c(a)?function(t,e,n){const o=e.length;let s=0,i=t.length-1,r=o-1;for(;s<=i&&s<=r&&d(t[s],e[s]);)N(t[s],e[s]),s++;for(;s<=i&&s<=r&&d(t[i],e[r]);)N(t[i],e[r]),i--,r--;if(s>i){if(s<=r){const t=r+1,i=t<o?e[t].el:null;for(;s<=r;)n.insertBefore(P(e[s]),i),s++}}else if(s>r)for(;s<=i;)n.removeChild(t[s].el),s++;else{const l=s,a=s,c=new Map;for(s=a;s<=r;s++){const t=e[s];null!=t.key&&c.set(t.key,s)}let u,f=0;const h=r-a+1;let p=!1,m=0;const g=new Array(h);for(s=0;s<h;s++)g[s]=0;for(let o=l;o<=i;o++){if(f>=h){n.removeChild(t[o].el);continue}let s;if(null!==t[o].key)s=c.get(t[o].key);else for(u=a;u<=r;u++)if(0===g[u-a]&&d(t[o],e[u])){s=u;break}void 0===s?n.removeChild(t[o].el):(g[s-a]=o+1,s>m?m=s:p=!0,N(t[o],e[s]),f++)}const b=p?function(t){const e=t.slice(),n=[0];let o,s,i,r,l;const a=t.length;for(o=0;o<a;o++){const a=t[o];if(0!==a){if(s=n[n.length-1],t[s]<a){e[o]=s,n.push(o);continue}for(i=0,r=n.length-1;i<r;)l=(i+r)/2|0,t[n[l]]<a?i=l+1:r=l;a<t[n[i]]&&(i>0&&(e[o]=n[i-1]),n[i]=o)}}for(i=n.length,r=n[i-1];i-- >0;)n[i]=r,r=e[r];return n}(g):[];u=b.length-1;for(let t=h-1;t>=0;t--){const s=t+a,i=s+1<o?e[s+1].el:null;0===g[t]?n.insertBefore(P(e[s]),i):p&&(u<0||t!==b[u]?n.insertBefore(e[s].el,i):u--)}}}(l,a,n):m(l)&&m(a)?N(l,a):g(l)||g(a)||l===a||_(a,n)}else{const n=t.el.parentNode,o=t.el.nextSibling;n.removeChild(t.el),P(e,n,o)}}function $(t){const[e,n]=t;class o extends HTMLElement{shadow;props;isComMounted;comOldTree;static get observedAttributes(){if(n.attributeChanged&&n.attributeChanged.length>0)return n.attributeChanged}constructor(){if(super(),this.shadow=null,this.props=Object.create(null),this.isComMounted=!1,this.comOldTree=Object.create(null),n.template&&e.name){const t=document.createElement("template");t.setAttribute("id",e.name);const o=t.content.cloneNode(!0);if(n.styles&&Array.isArray(n.styles)){const t=document.createElement("style");t.textContent=n.styles.join(""),o.appendChild(t)}if(this.shadow=this.attachShadow({mode:"open"}),this.shadow.appendChild(o),!n.attributeChanged){const t=n.template();P(t,this.shadow),T.set(e,{template:t,props:null})}}}connectedCallback(){const t=arguments;n.lifetimes&&"function"==typeof n.lifetimes.connectedCallback&&n.lifetimes.connectedCallback(t)}disconnectedCallback(){const t=arguments;n.lifetimes&&"function"==typeof n.lifetimes.disconnectedCallback&&n.lifetimes.disconnectedCallback(t)}adoptedCallback(){const t=arguments;n.lifetimes&&"function"==typeof n.lifetimes.adoptedCallback&&n.lifetimes.adoptedCallback(t)}attributeChangedCallback(){const t=arguments;if(n.attributeChanged&&n.attributeChanged.length>0){this.props[t[0]]=t[2];const o=n.template(this.props);this.isComMounted?(N(this.comOldTree,o),T.set(e,{template:o,props:this.props}),this.comOldTree=o):(P(o,this.shadow),T.set(e,{template:o,props:this.props}),this.comOldTree=o,this.isComMounted=!0)}n.immediateProps&&n.lifetimes&&"function"==typeof n.lifetimes.attributeChangedCallback&&n.lifetimes.attributeChangedCallback(t)}}-1!==e.name.indexOf("-")?customElements.define(e.name,o):b(`[${e.name}]>> please name the string with "-" as a custom element.`)}let B=[];function W(t=null){null!==t&&("function"==typeof t?B.push(t):console.warn("The parameter of onMounted is not a function!"))}let D=[];function R(t=null){null!==t&&("function"==typeof t?D.push(t):console.warn("The parameter of onUnmounted is not a function!"))}const q="undefined"!==c(Promise)&&Promise.resolve(),F=t=>q.then(t);let G=!1;function H(t,e){if(G){const e=t;N(A,e),A=e}else{if(P(t,e),A=t,G=!0,B.length>0)for(let t=0,e=B.length;t<e;t++)B[t]&&B[t]();B=[]}}function J(t,e){if("function"==typeof t&&"undefined"!=typeof Promise)return Promise.resolve().then((()=>{t()})).then((()=>{if(e){const t=c(e);if("array"===t&&"function"==typeof e[1]){const[t,n]=e,o=n();N(T.get(t),o),T.set(t,o)}else if("array"===t&&"object"==typeof e[1]){const[t,n]=e,{template:o,props:s}=T.get(t),i=n.template(s);N(o,i),T.set(t,i)}else if("string"===t&&"useRouter"===e){if(D.length>0)for(let t=0,e=D.length;t<e;t++)D[t]&&D[t]();D=[],G=!1,M.innerHTML="";H(S(),M)}}else{H(S(),null)}})).catch((t=>b(t)))}function I(t){return{mount(e){const n=function(t){if("string"==typeof t){const e=document.querySelector(t);if(!e){let e=null;return t.startsWith("#")?(e=document.createElement("div"),e.setAttribute("id",t.substring(1,t.length))):t.startsWith(".")?(e=document.createElement("div"),e.setAttribute("class",t.substring(1,t.length))):b(`Failed to mount app: mount target selector "${t}" returned null.`),document.body.insertAdjacentElement("afterbegin",e),e}return e}return t instanceof HTMLElement?t:window.ShadowRoot&&t instanceof window.ShadowRoot&&"closed"===t.mode?(b('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs.'),null):null}(e);if(n){const e=t();"array"===c(e)?b("Please provide a root node."):(S=t,M=n,H(e,M))}else b("There must be a mount element node.")}}}class U{_mutations;_actions;_state;constructor(t){this._mutations=t.mutations,this._actions=t.actions,this._state=new Proxy(t.state,{set:(t,e,n)=>(this._mutations[e]&&this._mutations[e](t,n),t[e]=n,!0)})}commit(t,e){this._mutations[t]&&this._mutations[t](this._state,e)}async dispatch(t,e){this._actions[t]&&await this._actions[t](this,e)}get state(){return this._state}}export{I as createApp,U as createStateFlow,E as domInfo,n as html,F as nextTick,W as onMounted,R as onUnmounted,L as registerComponent,J as setData,O as version};
