/*!
 * Strve.js v6.1.0
 * (c) 2021-2023 maomincoding
 * Released under the MIT License.
 */
function t(t){const e=Object.create(null),n=t.split(",");for(let t=0;t<n.length;t++)e[n[t]]=!0;return function(t){return e[t]}}const e=t("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot"),n=t("svg,animate,circle,clippath,cursor,image,defs,desc,ellipse,filter,font-faceforeignobject,g,glyph,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feFlood,feGaussianBlur,feImage,feMerge,feMorphology,feOffset,feSpecularLighting,feTile,feTurbulence,feDistantLight,fePointLight,feSpotLight,linearGradient,stop,radialGradient,animateTransform,animateMotion");function o(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)}const i={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},s="http://www.w3.org/1999/xlink";function r(t){return Object.prototype.toString.call(t).match(/\[object (.+?)\]/)[1].toLowerCase()}const l=["object","array","function","regexp","date","math"];function a(t){return l.includes(r(t))}function c(t){return null==t}function u(t,e){return t.tag===e.tag&&t.key===e.key}function f(t,e){return t.hasOwnProperty(e)}function d(t){if(t)return f(t,"tag")&&f(t,"props")&&f(t,"children")&&f(t,"key")&&f(t,"el")}function m(t){return Array.isArray(t)?function(t){return t.every(d)}(t):d(t)}function h(t){console.warn(`[Strve warn]: ${t}`)}function p(t,e){Object.assign(t.style,e)}function g(t,e){for(const[n,o]of Object.entries(e))if(n.startsWith("on")){const e=n.slice(2).toLowerCase();t.addEventListener(e,o)}}function b(t,e,n){if(e.startsWith("on")){const o=e.slice(2,3).toLowerCase()+e.slice(3);"function"==typeof n[e]&&t.removeEventListener(o,n[e])}}function y(t,e,n){if(o(e)){const o="http://www.w3.org/1999/xlink";t.setAttributeNS(o,e,n.toString())}else t.setAttribute(e,n.toString())}function w(t,e){var n;o(e)?t.removeAttributeNS(s,o(n=e)?n.slice(6,n.length):""):t.removeAttribute(e)}function C(t){switch(!0){case e(t):return document.createElement(t);case n(t):return o=function(t){return n(t)?"svg":"math"===t?"math":void 0}(t),s=t,document.createElementNS(i[o],s);case"fragment"===t||"component"===t:return document.createDocumentFragment();case"comment"===t||"null"===t:return document.createComment(t);default:return document.createElement(t)}var o,s}const k="6.1.0";let v=Object.create(null),j=Object.create(null),O=Object.create(null);const M=["$ref","$name","$define"],S=new WeakMap,A=new WeakMap;function x(t){const e=Object.create(null);return t?(e.name=t,e):e}function T(t,e){let n="";if(Array.isArray(t))if(t.length>1){let e=[];for(let n=0;n<t.length;n++){const o=t[n];e.push(a(o)?JSON.stringify(o):o)}n=e.join("")}else n=0===t.length?"":JSON.stringify(t).replace(/,/g,"");else n=a(t)?JSON.stringify(t):t;e.textContent=n}function E(t,e,n){const{tag:o,props:i,children:s}=t;if(!c(o)){const l=C(o);if(t.el=l,!c(i)){g(l,i);const t=Object.keys(i);for(let e=0;e<t.length;e++){const n=t[e],o=i[n],a=r(o);if("function"===a||"key"===n||M.includes(n)||y(l,n,o),"style"===n&&"object"===a&&p(l,o),n===M[0]&&"object"===a&&A.set(o,l),n===M[1]&&"object"===a&&S.set(o,s),n===M[2]&&"array"===a){const[t,e]=o;if(customElements.get(t.name)){const n=e.template();S.set(t,{template:n,props:null})}else _(o)}}}if(!c(s))if(m(s)){const t=r(s);if("array"===t)for(let t=0;t<s.length;t++){const e=s[t];d(e)&&E(e,l)}else"object"===t&&E(s,l)}else l&&T(s,l);if(n)e.insertBefore(l,n);else{if(!e)return l;e.appendChild(l)}}}function L(t,e){if(u(t,e)){const n=e.el=t.el,o=t.props||{},i=e.props||{},s=Object.keys(i),l=Object.keys(o);for(let t=0;t<s.length;t++){const e=s[t],l=i[e],a=o[e],u=r(l);l!==a&&(c(l)?w(n,e):("function"===u||"key"===e||M.includes(e)||y(n,e,l),"style"===e&&"object"===u&&p(n,l),"function"===u&&l.toString()!==a.toString()&&(b(n,e,o),g(n,i))))}for(let t=0;t<l.length;t++){const e=l[t];s.includes(e)||w(n,e)}const a=t.children,f=e.children;"array"===r(a)&&"array"===r(f)?function(t,e,n){const o=e.length;let i=0,s=t.length-1,r=o-1;for(;i<=s&&i<=r&&u(t[i],e[i]);)L(t[i],e[i]),i++;for(;i<=s&&i<=r&&u(t[s],e[r]);)L(t[s],e[r]),s--,r--;if(i>s){if(i<=r){const t=r+1,s=t<o?e[t].el:null;for(;i<=r;)n.insertBefore(E(e[i]),s),i++}}else if(i>r)for(;i<=s;)n.removeChild(t[i].el),i++;else{const l=i,a=i,c=new Map;for(i=a;i<=r;i++){const t=e[i];null!=t.key&&c.set(t.key,i)}let f,d=0;const m=r-a+1;let h=!1,p=0;const g=new Array(m);for(i=0;i<m;i++)g[i]=0;for(let o=l;o<=s;o++){if(d>=m){n.removeChild(t[o].el);continue}let i;if(null!==t[o].key)i=c.get(t[o].key);else for(f=a;f<=r;f++)if(0===g[f-a]&&u(t[o],e[f])){i=f;break}void 0===i?n.removeChild(t[o].el):(g[i-a]=o+1,i>p?p=i:h=!0,L(t[o],e[i]),d++)}const b=h?function(t){const e=t.slice(),n=[0];let o,i,s,r,l;const a=t.length;for(o=0;o<a;o++){const a=t[o];if(0!==a){if(i=n[n.length-1],t[i]<a){e[o]=i,n.push(o);continue}for(s=0,r=n.length-1;s<r;)l=(s+r)/2|0,t[n[l]]<a?s=l+1:r=l;a<t[n[s]]&&(s>0&&(e[o]=n[s-1]),n[s]=o)}}for(s=n.length,r=n[s-1];s-- >0;)n[s]=r,r=e[r];return n}(g):[];f=b.length-1;for(let t=m-1;t>=0;t--){const i=t+a,s=i+1<o?e[i+1].el:null;0===g[t]?n.insertBefore(E(e[i]),s):h&&(f<0||t!==b[f]?n.insertBefore(e[i].el,s):f--)}}}(a,f,n):d(a)&&d(f)?L(a,f):m(a)||m(f)||a===f||T(f,n)}else{const n=t.el.parentNode,o=t.el.nextSibling;n.removeChild(t.el),E(e,n,o)}}function _(t){const[e,n]=t;class o extends HTMLElement{shadow;props;isComMounted;comOldTree;static get observedAttributes(){if(n.attributeChanged&&n.attributeChanged.length>0)return n.attributeChanged}constructor(){if(super(),this.shadow=null,this.props=Object.create(null),this.isComMounted=!1,this.comOldTree=Object.create(null),n.template&&e.name){const t=document.createElement("template");t.setAttribute("id",e.name);const o=t.content.cloneNode(!0);if(n.styles&&Array.isArray(n.styles)){const t=document.createElement("style");t.textContent=n.styles.join(""),o.appendChild(t)}if(this.shadow=this.attachShadow({mode:"open"}),this.shadow.appendChild(o),!n.attributeChanged){const t=n.template();E(t,this.shadow),S.set(e,{template:t,props:null})}}}connectedCallback(){const t=arguments;n.lifetimes&&"function"==typeof n.lifetimes.connectedCallback&&n.lifetimes.connectedCallback(t)}disconnectedCallback(){const t=arguments;n.lifetimes&&"function"==typeof n.lifetimes.disconnectedCallback&&n.lifetimes.disconnectedCallback(t)}adoptedCallback(){const t=arguments;n.lifetimes&&"function"==typeof n.lifetimes.adoptedCallback&&n.lifetimes.adoptedCallback(t)}attributeChangedCallback(){const t=arguments;if(n.attributeChanged&&n.attributeChanged.length>0){this.props[t[0]]=t[2];const o=n.template(this.props);this.isComMounted?(L(this.comOldTree,o),S.set(e,{template:o,props:this.props}),this.comOldTree=o):(E(o,this.shadow),S.set(e,{template:o,props:this.props}),this.comOldTree=o,this.isComMounted=!0)}n.immediateProps&&n.lifetimes&&"function"==typeof n.lifetimes.attributeChangedCallback&&n.lifetimes.attributeChangedCallback(t)}}-1!==e.name.indexOf("-")?customElements.define(e.name,o):h(`[${e.name}]>> please name the string with "-" as a custom element.`)}let P=[];function N(t=null){null!==t&&("function"==typeof t?P.push(t):console.warn("The parameter of onMounted is not a function!"))}let B=[];function W(t=null){null!==t&&("function"==typeof t?B.push(t):console.warn("The parameter of onUnmounted is not a function!"))}const $="undefined"!==r(Promise)&&Promise.resolve(),D=t=>$.then(t);let R=!1;function q(t,e){if(R){const e=t;L(O,e),O=e}else{if(E(t,e),O=t,R=!0,P.length>0)for(let t=0,e=P.length;t<e;t++)P[t]&&P[t]();P=[]}}function F(t,e){if("function"==typeof t&&"undefined"!=typeof Promise)return Promise.resolve().then((()=>{t()})).then((()=>{if(e){const t=r(e);if("array"===t&&"function"==typeof e[1]){const[t,n]=e,o=n();L(S.get(t),o),S.set(t,o)}else if("array"===t&&"object"==typeof e[1]){const[t,n]=e,{template:o,props:i}=S.get(t),s=n.template(i);L(o,s),S.set(t,s)}else if("string"===t&&"useRouter"===e){if(B.length>0)for(let t=0,e=B.length;t<e;t++)B[t]&&B[t]();B=[],R=!1,v.innerHTML="";q(j(),v)}}else{q(j(),null)}})).catch((t=>h(t)))}function G(t){return{mount(e){const n=function(t){if("string"==typeof t){const e=document.querySelector(t);if(!e){let e=null;return t.startsWith("#")?(e=document.createElement("div"),e.setAttribute("id",t.substring(1,t.length))):t.startsWith(".")?(e=document.createElement("div"),e.setAttribute("class",t.substring(1,t.length))):h(`Failed to mount app: mount target selector "${t}" returned null.`),document.body.insertAdjacentElement("afterbegin",e),e}return e}return t instanceof HTMLElement?t:window.ShadowRoot&&t instanceof window.ShadowRoot&&"closed"===t.mode?(h('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs.'),null):null}(e);if(n){const e=t();"array"===r(e)?h("Please provide a root node."):(j=t,v=n,q(e,v))}else h("There must be a mount element node.")}}}class H{_mutations;_actions;_state;constructor(t){this._mutations=t.mutations,this._actions=t.actions,this._state=new Proxy(t.state,{set:(t,e,n)=>(this._mutations[e]&&this._mutations[e](t,n),t[e]=n,!0)})}commit(t,e){this._mutations[t]&&this._mutations[t](this._state,e)}async dispatch(t,e){this._actions[t]&&await this._actions[t](this,e)}get state(){return this._state}}export{G as createApp,H as createStateFlow,A as domInfo,D as nextTick,N as onMounted,W as onUnmounted,x as registerComponent,F as setData,k as version};
